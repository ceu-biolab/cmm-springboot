{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "CE-MS Search Request",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "buffer_code",
    "polarity",
    "chemical_alphabet",
    "ionization_mode",
    "adducts",
    "mz_values",
    "effective_mobilities",
    "mz_tolerance",
    "mz_tolerance_mode",
    "eff_mob_tolerance",
    "temperature"
  ],
  "properties": {
    "buffer_code": {
      "type": "string",
      "description": "Buffer code as stored in ce_buffer_type.buffer_code (e.g. FORMIC_ACID_1M)."
    },
    "temperature": {
      "type": "number",
      "description": "Experimental temperature in Celsius"
    },
    "polarity": {
      "type": "string",
      "enum": ["Direct", "Reverse"],
      "description": "CE polarity setting."
    },
    "chemical_alphabet": {
      "type": "string",
      "description": "Allowed element letters. Example: CHNOPS (only C, H, N, O, P, S)."
    },
    "ionization_mode": {
      "type": "string",
      "enum": ["Positive", "Negative"]
    },
    "adducts": {
      "type": "array",
      "description": "Candidate adducts to consider during matching.",
      "items": { "type": "string" },
      "minItems": 1,
      "uniqueItems": true
    },
    "mz_values": {
      "type": "array",
      "description": "Observed m/z values to search.",
      "items": {
        "type": "number",
        "exclusiveMinimum": 0
      },
      "minItems": 1
    },
    "effective_mobilities": {
      "type": "array",
      "description": "List of effective mobilities.",
      "items": {
        "type": "number"
      },
      "minItems": 1
    },
    "mz_tolerance": {
      "type": "number",
      "exclusiveMinimum": 0,
      "description": "Mass tolerance value. Interpreted per mz_tolerance_mode."
    },
    "mz_tolerance_mode": {
      "type": "string",
      "enum": ["ppm", "mDa"]
    },
    "eff_mob_tolerance": {
      "type": "number",
      "minimum": 0,
      "description": "Effective mobility tolerance interpreted per eff_mob_tolerance_mode."
    },
    "eff_mob_tolerance_mode": {
      "type": "string",
      "enum": ["percentage", "absolute"],
      "description": "Specifies how eff_mob_tolerance should be applied."
    }
  },

  "examples": [
    {
      "buffer_code": "AMMONIUM_ACETATE_50mM",
      "polarity": "Direct",
      "chemical_alphabet": "CHNOPS",
      "ionization_mode": "Positive",
      "adducts": ["M+H", "M+Na"],
      "mz_values": [291.3, 298.6, 305.1, 322.8],
      "effective_mobilities": [1174, 1060, 995, 880],
      "mz_tolerance": 10,
      "mz_tolerance_mode": "ppm",
      "eff_mob_tolerance": 5,
      "eff_mob_tolerance_mode": "percentage",
      "temperature": 20
    }
  ]
}
